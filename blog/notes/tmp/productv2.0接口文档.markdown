# Product v2.0接口文档

## 1 总述

本文档所有接口基于HTTP方式访问。

### 1.1 接口地址

**正式环境URL：**  

**测试环境URL：**  

**联调环境URL：** http://product_v2.0.hdw/   (须修改hosts文件指向192.168.1.155)  

### 1.2 请求参数类型

文档中所有的入参数可变部分，以大括号｛｝包围。

- **路径参数：**http请求中路径部分中的参数
- **请求参数：**http请求中query string中的参数

### 1.3 接口返回值格式

所有接口以JSON格式返回结果，格式如下：

	{

		"code":0,

		"data":,

		"msg":"ok",

	}

结果描述：  

code：为0则程序执行正常，为其它值时结果异常。  

data：结果。  

msg: 程序执行正常返回"ok"，异常则返回异常描述。

`接口返回结果中直接给出data的值，不再描述该结构。`



### 1.4 加密方式

先在后台做ip限制，仅允许前端代理层访问。待功能上线后，再考虑加入其它认证方式。



## 2 用户服务接口

### 2.1 openId登录

| 类型     | 描述                                              | 
| ------ | ----------------------------------------------- | 
| 接口描述   | 微信重新绑定手机号可以用这个方法，把openId传过来                     | 
| 请求类型   | POST                                            | 
| 路径参数   | /User/openIdLogin                               | 
| 查询参数   |                                                 | 
| POST参数 | mobile={mobile}&code={code},openId={openId}     | 
| 参数说明   | `mobile:用户登录手机号,code:验证吗,openId:{微信绑定后的openId}` | 
| 输出格式   | true                                            | 
| 输出说明   | 当前登录成功,返回true，登录失败返回出错信息                        | 

### 2.2 用户登录

| 类型     | 描述                                  | 
| ------ | ----------------------------------- | 
| 接口描述   | 用户普通登录                              | 
| 请求类型   | POST                                | 
| 路径参数   | /User/login                         | 
| 查询参数   |                                     | 
| POST参数 | mobile={mobile}&password={password} | 
| 参数说明   | mobile:用户登录手机号,password:用户密码        | 
| 输出格式   | true                                | 
| 输出说明   | 当前登录成功,返回true，登录失败返回出错信息            | 

### 2.3 注销登录

| 类型   | 描述                   | 
| ---- | -------------------- | 
| 接口描述 | 注销当前登录信息             | 
| 请求类型 | GET                  | 
| 路径参数 | /User/logout         | 
| 查询参数 |                      | 
| 参数说明 |                      | 
| 输出格式 | true                 | 
| 输出说明 | 注销成功,返回true，失败返回出错信息 | 

### 2.4 当前用户是否登录

| 类型   | 描述                    | 
| ---- | --------------------- | 
| 接口描述 | 用户                    | 
| 请求类型 | GET                   | 
| 路径参数 | /User/checkLogin      | 
| 查询参数 |                       | 
| 参数说明 |                       | 
| 输出格式 | true                  | 
| 输出说明 | 已经登录返回true，未登录返回false | 

### 2.5 重置用户密码

| 类型     | 描述                                                              | 
| ------ | --------------------------------------------------------------- | 
| 接口描述   | 重置用户密码                                                          | 
| 请求类型   | POST                                                            | 
| 路径参数   | /User/resetPassword                                             | 
| 查询参数   |                                                                 | 
| POST参数 | mobile={mobile}&password={password}&new_password={new_password} | 
| 参数说明   | mobile:用户登录手机号,password:用户密码,new_password:要重置成的新密码              | 
| 输出说明   | 重置成功返回true，失败返回出错信息                                             | 

### 2.6 发送短信验证码接口

| 类型     | 描述                                                                               | 
| ------ | -------------------------------------------------------------------------------- | 
| 接口描述   | 短信验证码发送接口,发送短信验证码后10分钟内不进行验证，则验证码失效                                              | 
| 请求类型   | GET                                                                              | 
| 路径参数   | /User/genSMSCaptcha                                                              | 
| 查询参数   | action={action}&phone={phone}                                                    | 
| POST参数 |                                                                                  | 
| 参数说明   | action：发送短信验证码的用途，可选值有rebindPhone, resetPassword, register; <br>phone：要发送验证码的手机号 | 
| 输出     | {true}                                                                           | 

### 2.7 绑定新手机号

| 类型     | 描述                                                    | 
| ------ | ----------------------------------------------------- | 
| 接口描述   | 绑定手机号                                                 | 
| 请求类型   | POST                                                  | 
| 路径参数   | /User/rebindPhone                                     | 
| 查询参数   |                                                       | 
| POST参数 | phone={phone}&code={code}&new_phone={new_phone}       | 
| 参数说明   | phone：要发送验证码的手机号<br> code:短信验证码<br>new_phone:要绑定的新手机号 | 
| 输出     | {userId:???}                                          | 

### 2.8 验证码是否正确

| 类型     | 描述                            | 
| ------ | ----------------------------- | 
| 接口描述   | 检验用户输入的验证码与系统发送的短信验证码是否一致     | 
| 请求类型   | POST                          | 
| 路径参数   | /User/validSMSCode            | 
| 查询参数   |                               | 
| POST参数 | phone={phone}&code={code}     | 
| 参数说明   | phone：验证码生成手机号<br> code:短信验证码 | 
| 输出     | true                          | 

### 2.9 通过手机重置密码

| 类型     | 描述                                             | 
| ------ | ---------------------------------------------- | 
| 接口描述   | 通过手机得到验证码后，重置密码                                | 
| 请求类型   | POST                                           | 
| 路径参数   | /User/resetPasswordViaSMSCode                  | 
| 查询参数   |                                                | 
| POST参数 | phone={phone}&code={code}&password={password}  | 
| 参数说明   | phone：验证码生成手机号<br> code:短信验证码<br>password: 新密码 | 
| 输出     | true                                           | 

### 2.10 取用户信息

| 类型     | 描述                                               | 
| ------ | ------------------------------------------------ | 
| 接口描述   | 个人信息页面，取用户信息                                     | 
| 请求类型   | GET                                              | 
| 路径参数   | /User/get                                        | 
| 查询参数   | phone={phone}或userId={userId}或登录用户不用传参           | 
| POST参数 |                                                  | 
| 参数说明   | phone：验证码生成手机号<br> userId:用户id<br>登录用户直接取登录的用户信息 | 
| 输出     | true                                             | 

### 2.11 获取用户爱车列表

| 类型     | 描述                           | 
| ------ | ---------------------------- | 
| 接口描述   | 取用户爱车列表                      | 
| 请求类型   | GET                          | 
| 路径参数   | /User/car                    | 
| 查询参数   | userId={userId}或登录用户不用传参     | 
| POST参数 |                              | 
| 参数说明   | userId:用户id<br>登录用户可以不用传递该参数 | 
| 输出     | true                         | 

### 2.12 添加/修改用户爱车

| 类型     | 描述                           | 
| ------ | ---------------------------- | 
| 接口描述   | 添加/修改用户爱车 | 
| 请求类型   | POST          | 
| 路径参数   | /User/car    | 
| 查询参数   | userId={userId}&id={id} | 
| POST参数   | carId={carId}&[carLicense={carLicense}&carFrame={carFrame}&carEngine={carEngine}&isTop={isTop}] | 
| 参数说明   | userId:用户id,登录用户可以不用传递该参数<br>carId:选中的车型id，如果为品牌或车系不能保存<br>id:用户爱车id，修改车型时需带该值，不带为新增 |
| 输出     | 更新成功返回true，插入成功返回新生成的id | 


### 2.13 用户爱车删除
| 类型     | 描述                                              | 
| ------ | ----------------------------------------------- | 
| 接口描述   | 删除用户爱车                                          | 
| 请求类型   | DELETE                                          | 
| 路径参数   | /User/car                                       | 
| 查询参数   | userId={userId}&id={id} | 
| POST参数 |                                                 | 
| 参数说明   | userId:用户id, 已登录用户可不用传递该参数<br>id: 用户的车id | 
| 输出     | true |


#### 2.4.3 用户优惠券

添加优惠码、取优惠券列表



#### 2.4.4 用户地址

添加、删除、修改、设为默认

#### 2.4.5 用户绑定手机





## 3 产品服务接口(预约保养)

### 3.1 获取服务分类

| 类型   | 描述                                                                                   | 
| ---- | ------------------------------------------------------------------------------------ | 
| 接口描述 | 获取服务分类列表(小保养、空调洗车、镀模)                                                                | 
| 请求类型 | GET                                                                                  | 
| 路径参数 | /Service_category/fetch/                                                             | 
| 查询参数 |                                                                                      | 
| 参数说明 |                                                                                      | 
| 输出   | <pre>[{"id":"1","name":"小保养","status":"1","price":"10.00","discount":"1"},...]</pre> | 

### 3.2 获取品牌/车系/型号

| 类型   | 描述                                                                                                                                                                                      | 
| ---- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | 
| 接口描述 | 获取品牌/车系/型号信息                                                                                                                                                                            | 
| 请求类型 | GET                                                                                                                                                                                     | 
| 路径参数 | /car/fetch/                                                                                                                                                                             | 
| 查询参数 | pid={pid}                                                                                                                                                                               | 
| 参数说明 | pid:树结构层级id，pid为空或不传参，返回整个品牌/车系/型号的树形结构，pid为0，返回品牌。>0时，返回车系或型号                                                                                                                          | 
| 输出   | 1、pid>=0时，返回格式为：<pre>[{"name":"阿尔法","id":"1","level":"0-1","superior_id":"0","initial":"A","status":"1"},...]</pre> <br> 2、pid为空时：以树形结构返回所有结果，level为整数，父级在childs中包含子级; 整个返回值为对象，以id为下标。 | 

### 3.3 获取配件信息
| 类型   | 描述                          | 
| ---- | --------------------------- | 
| 接口描述 | 下单时获取配件配件信息                   | 
| 请求类型 | GET                        | 
| 路径参数 | /Service_config/fetchProducts| 
| 查询参数 | carId={carId}&userId={userId}| 
| 参数说明 | carId:当前所选车型id<br>phone:预约人电话<br>userId:请求人id，登录用户可省略userId |
| 输出格式 | true               | 




### 3.4 电话预约
| 类型   | 描述                          | 
| ---- | --------------------------- | 
| 接口描述 | 电话预约                   | 
| 请求类型 | POST                        | 
| 路径参数 | /order/addPhoneOrder           | 
| 查询参数 | userId={userId}，登录用户不用该串| 
| POST参数 | name={name}&phone={phone}|
| 参数说明 | name:预约人姓名<br>phone:预约人电话<br>userId:请求人id，登录用户可省略该id |
| 输出格式 | true               | 


## 4 订单接口

### 4.1 提交订单

| 类型   | 描述                          | 
| ---- | --------------------------- | 
| 接口描述 | 提交表单项，生成订单号                 | 
| 请求类型 | POST                        | 
| 路径参数 | /order/add                  | 
| 查询参数 |                             | 
| 参数说明 |                             | 
| 输出格式 | [order_id]                  | 
| 输出说明 | 返回数组,成功返回order_id，否则按错误信息返回 | 

### 4.2 订单支付

### 4.3 订单详情

### 4.4 申请退款

### 4.5 取总订单数

| 类型   | 描述                          | 
| ---- | --------------------------- | 
| 接口描述 | 获取总订单数量，前期在现有订单数量基础上加上20000 | 
| 请求类型 | GET                         | 
| 路径参数 | /order/getOrderCount        | 
| 查询参数 |                             | 
| 参数说明 |                             | 
| 输出格式 | [rows]                      | 
| 输出说明 | 返回数组,rows为订单总数量             | 

### 4.6 用户评论

评论项，评论内容

### 4.7 用户投诉

### 4.8 用户订单可选时段







## 5 车辆体验报告



## 6 非接口类消息推送

### 6. 体验报告状态消息推送

### 6. 投诉状态消息推送

### 6. 退款状态消息推送