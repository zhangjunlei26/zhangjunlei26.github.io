{"root":{"data":{"text":"模块机制","expandState":"expand"},"children":[{"data":{"text":"CommonJS规范","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"CommonJS的出发点","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"JavaScript规范缺陷","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"没有模块系统","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"标准库较少","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"没有标准接口","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"缺乏包管理系统","layout_right_offset":null,"layout":null},"children":[]}]},{"data":{"text":"希望JavaScript具备开发大型应用的基本能力","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"开发富客户端应用","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"服务端JavaScript应用程序","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"桌面图形界面界面应用程序","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"混合应用（Titanium和Adobe AIR等形式的应用）","layout_right_offset":null,"layout":null},"children":[]}]},{"data":{"text":"结果","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"Node借鉴CommonJS的Modules规范实现了一套非常易用的模块系统","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"NPM对Packages规范的完好支持使得Node在应用开发中事半功倍","layout_right_offset":null,"layout":null},"children":[]}]}]},{"data":{"text":"CommonJS的模块规范","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"模块引用","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84uo0pcso0g","created":1477580765182,"text":"require('math')"},"children":[]}]},{"data":{"text":"模块定义","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84uo6rpahsk","created":1477580778385,"text":"exports.add=function(){}"},"children":[]}]},{"data":{"text":"模块标识","layout_right_offset":null,"layout":null},"children":[]}]}]},{"data":{"text":"Node模块的实现","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"模块分类","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"核心模块：Node提供的c++模块","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84uq4kxjgw8","created":1477580930350,"text":"在路径分析中优先判断，加载速度最快"},"children":[]}]},{"data":{"text":"文件模块：用户编写的js模块","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84uqiadp6w4","created":1477580960187,"text":"路径分析->文件定位->编译执行"},"children":[]}]}]},{"data":{"text":"模块加载过程","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"优先从缓存加载","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84urx9ilwoo","created":1477581071151,"text":"node中缓存的是编译和执行之后的对象"},"children":[]}]},{"data":{"text":"路径分析和文件定位","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"模块标识符分析(require(模块))","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"核心模块（http/fs/path等)","layout_right_offset":null,"layout":null},"children":[]},{"data":{"id":"b84uuwwpx4w0","created":1477581305469,"text":"路径形式的文件模块","expandState":"expand"},"children":[{"data":{"id":"b84uu1r0siok","created":1477581237644,"text":".或..开头的相对路径文件模块"},"children":[]},{"data":{"text":"以/开始的绝对路径模块","layout":null},"children":[]}]},{"data":{"text":"如自定义模块","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84uw8ba1l44","created":1477581408658,"text":"非路径形式模块，查找最慢"},"children":[]}]}]},{"data":{"text":"文件定位","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"文件扩展名分析（.js,.json,.node次序补足扩展名）","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84v5lzwoq0o","created":1477582143723,"text":"为避免fs模块同步阻塞式判断文件存在否，json/node带上扩展名"},"children":[]}]},{"data":{"text":"目录分析和包","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84v7rb097kk","created":1477582312007,"text":"未找到包对应文件，而找到目录，从目录下找"},"children":[{"data":{"id":"b84v8y2pifsc","created":1477582405106,"text":"package.json"},"children":[{"data":{"id":"b84v9dd82ts8","created":1477582438394,"text":"main指定的路径"},"children":[]}]},{"data":{"id":"b84v90mr5zk8","created":1477582410672,"text":"index.js/index.json/index.node"},"children":[]}]}]}]},{"data":{"text":"模块编译","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84vhf6a8bcc","created":1477583069241,"text":"总述"},"children":[{"data":{"id":"b84vhtjq93sc","created":1477583100529,"text":"不同文件扩展名，不同的加载方式"},"children":[]},{"data":{"id":"b84vi7ndm800","created":1477583131225,"text":"require.extensions可以知道已有的扩展加载方式"},"children":[]},{"data":{"id":"b84viuhrpggk","created":1477583180952,"text":"自定义扩展名的特殊加载方式，可通过require.extensions['.ext']=function(){}来实现"},"children":[]},{"data":{"id":"b84vjmpgysgk","created":1477583242367,"text":"早期的coffee的加载方式通过require.extensions['.coffee']=function(){}来实现"},"children":[]}]},{"data":{"text":".js文件。通过fs模块同步读取文件后编译执行","layout":null},"children":[{"data":{"id":"b84vky00g54w","created":1477583345314,"text":"每个模块被包装后加载(function(exports,require,module,__filename,__dirname){\nvar math = require('math');\nexports.args=function(r){}\n});"},"children":[]}]},{"data":{"text":".node文件","layout_right_offset":null,"layout":null,"expandState":"expand"},"children":[{"data":{"text":"用C/C++编写的扩展文件，"},"children":[]},{"data":{"text":"通过dlopen()方法加载最后编译生成的文件"},"children":[]}]},{"data":{"text":".json文件","layout_right_offset":null,"layout":null,"expandState":"expand"},"children":[{"data":{"text":"通过fs模块同步读取文件后，"},"children":[]},{"data":{"text":"用JSON.parse()解析返回结果"},"children":[]}]},{"data":{"text":"其他扩展名文件。他们被当作.js文件载入","layout_right_offset":null,"layout":null},"children":[]}]}]}]}]},{"data":{"text":"核心模块","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"JavaScript核心模块的编译过程","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"转存为C/C++代码","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"编译为JavaScript核心模块","expandState":"expand","layout_right_offset":null,"layout":null},"children":[]}]},{"data":{"text":"C/C++核心模块的编译过程","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"内建模块的组织形式","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"内建模块的导出","layout_right_offset":null,"layout":null},"children":[]}]},{"data":{"text":"核心模块的引入流程","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"1.NODE_MODULE(node_os,reg_func)","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"2.get_builtin_module(\"node_os\")","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"3.process.binding(\"os\")","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"4.NativeModule.require(\"os\")","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"5.require(\"os\")","layout_right_offset":null,"layout":null},"children":[]}]},{"data":{"text":"编写核心模块","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"前提条件","expandState":"expand","layout_right_offset":null,"layout":null},"children":[{"data":{"text":"GYP项目生成工具","layout_right_offset":null,"layout":null},"children":[{"data":{"id":"b84w2uky4co4","created":1477584748427,"text":"npm install -g node-gyp"},"children":[]}]},{"data":{"text":"V8引擎C++库","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"libuv库","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"Node内部库","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"其他库，zlib、openssl、http_parser等","layout_right_offset":null,"layout":null},"children":[]}]},{"data":{"text":"C/C++扩展模块的编写","layout_right_offset":null,"layout":null},"children":[]},{"data":{"text":"C/C++扩展模块的编译"},"children":[]},{"data":{"text":"C/C++扩展模块的加载"},"children":[]}]}]},{"data":{"text":"包与NPM","expandState":"expand"},"children":[{"data":{"text":"包结构","expandState":"expand"},"children":[{"data":{"text":"package.json：包描述文件"},"children":[]},{"data":{"text":"bin：用于存放可执行二进制文件的目录"},"children":[]},{"data":{"text":"lib：用于存放JavaScript代码的目录"},"children":[]},{"data":{"text":"doc：用于存放文档的目录"},"children":[]},{"data":{"text":"test：用于存放单元测试用例的代码"},"children":[]}]},{"data":{"text":"包描述文件与NPM","expandState":"expand"},"children":[{"data":{"text":"必需字段：name，description，version，keywords，maintainers "},"children":[]},{"data":{"text":"必须字段：contributios，bugs，licences，repositories，dependencies"},"children":[]}]},{"data":{"text":"NPM常用功能","expandState":"expand"},"children":[{"data":{"text":"查看帮助: npm -v"},"children":[]},{"data":{"text":"安装依赖包","expandState":"expand"},"children":[{"data":{"text":"最常见: npm install express"},"children":[]},{"data":{"text":"全局安装：npm install express -g"},"children":[]},{"data":{"text":"从本地安装：npm install <file>"},"children":[]},{"data":{"text":"从非官方源安装：npm install underscore --registry=http://registry.url"},"children":[]}]},{"data":{"text":"NPM钩子命令","expandState":"expand"},"children":[]},{"data":{"text":"发布包"},"children":[]},{"data":{"text":"分析包"},"children":[]}]},{"data":{"text":"NPM潜在问题","expandState":"expand"},"children":[{"data":{"text":"NPM平台上面包质量良莠不齐"},"children":[]},{"data":{"text":"Node代码可以运行在服务端，需要考虑安全问题"},"children":[]}]}]},{"data":{"text":"前后端共用模块","expandState":"expand"},"children":[{"data":{"text":"模块的侧重点"},"children":[]},{"data":{"text":"AMD规范：是CommonJS模块规范的一个延伸"},"children":[]},{"data":{"text":"CMD规范：玉伯提出，区别定义模块和依赖引入"},"children":[]},{"data":{"text":"兼容多种模块规范"},"children":[]}]}]},"template":"right","theme":"fresh-blue-compat","version":"1.4.43"}